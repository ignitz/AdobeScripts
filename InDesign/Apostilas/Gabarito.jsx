/*2016 Yuri Niitsuma <ignitzhjfk@gmail.com>*/function setTransparency(option){    var links = app.selection[0].allPageItems;    for(var i = 0; i < links.length; i++)    {        if(links[i].toString() == '[object TextFrame]')            if(links[i].contentType == ContentType.TEXT_TYPE && (links[i].contents.substring(0, 8) == 'GABARITO') || links[i].contents.substring(0, 5) == 'SECAO')                links[i].transparencySettings.blendingSettings.opacity = option;    }}function gerarGabarito(){    var filePath = "~/Desktop/" + app.activeDocument.name + "_GABARITO.txt";    var gabFile = new File(filePath);    gabFile.encoding = "UTF-8";    gabFile.open("w");    var gabarito = '';    var countQuest = 1;    var links = app.selection[0].allPageItems;        for(var i = 0; i < links.length; i++)    {        if(links[i].toString() == '[object TextFrame]')            if(links[i].contentType == ContentType.TEXT_TYPE)            {                if (links[i].contents.substring(0, 8) == 'GABARITO')                {                    if(countQuest < 10)                        gabarito = gabarito + '0' + (countQuest++) + '.\t' + links[i].contents.substring(10, links[i].contents.length) + '\n';                    else                        gabarito = gabarito + (countQuest++) + '.\t' + links[i].contents.substring(10, links[i].contents.length) + '\n';                }                else if (links[i].contents.substring(0, 5) == 'SECAO')                {                     gabarito = gabarito + links[i].contents.substring(7, links[i].contents.length) + '\n';                     countQuest = 1;                };            }    }        gabFile.write(gabarito);    gabFile.close();}function deleteFrame(){    var links = app.selection[0].allPageItems;        for(var i = 0; i < links.length; i++)        if(links[i].toString() == '[object TextFrame]')            if(links[i].contentType == ContentType.TEXT_TYPE)                if (links[i].contents.substring(0, 8) == 'GABARITO' || links[i].contents.substring(0, 5) == 'SECAO')                    links[i].remove();}function myDisplayDialog(){	var myDialog, myTabButtons;	with(myDialog = app.dialogs.add({name:"Gabarito Maker v0.2 - Yuri Niitsuma"})){		with(dialogColumns.add()){			with(borderPanels.add()){                  staticTexts.add({staticLabel:"Escolha a opção:"});				with(myTabButtons = radiobuttonGroups.add()){					radiobuttonControls.add({staticLabel:"Opacidade = 0%"});					radiobuttonControls.add({staticLabel:"Opacidade = 100%"});					radiobuttonControls.add({staticLabel:"Gerar gabarito", checkedState:true});                       radiobuttonControls.add({staticLabel:"Apagar Text_Frames. (Utilize no pré-print)"});;                    // radiobuttonControls.add({staticLabel:"Aplicar Bold no GABARITO:"});				}			}			with(borderPanels.add()){                staticTexts.add({staticLabel:"Obs: Funciona em apenas objetos TEXT_FRAME no formato \"GABARITO: X\""});			//		with(dialogColumns.add()){			//		myTabLeaderField = textEditboxes.add({editContents:""});			//	}			}		}	}	var myResult = myDialog.show();	if(myResult == true){		// var myTabType = myTabButtons.selectedButton;        switch(myTabButtons.selectedButton)        {            case 0:                setTransparency (0);                break;            case 1:                setTransparency (100);                break;            case 2:                gerarGabarito();                break;            case 3:                deleteFrame();                break;            default:                break;        }		myDialog.destroy();	}	else{		myDialog.destroy();	}}myDisplayDialog ();