/*2015 Yuri Niitsuma <ignitzhjfk@gmail.com>*///~ var coisa = app.activeDocument.allPageItems;//~ $.writeln(coisa);//~ for(var i = 0; i < coisa.length; i++)//~ {//~     alert(coisa[i].characters);//~ }//~ app.cut();//~ app.documents.add().textFrames.add({geometricBounds : [12.7, 12.7, 271.6, 184.6]}); // Tem que ser em mm//~ app.activeDocument.allPageItems[0].parentStory.texts[0].select();//~ app.paste();//~ app.activeDocument.save();//~ app.activeDocument.close();var prefixo = 0;// var prefixo = prompt("Insira o capítulo.","")function copyQuestion(numQuest){    app.copy();    app.documents.add().textFrames.add({geometricBounds : [12.7, 12.7, 271.6, 184.6]}); // Tem que ser em mm    app.activeDocument.allPageItems[0].parentStory.texts[0].select();    app.paste();    alladin = app.selection[0].paragraphs;    if(numQuest <10)    {        if(prefixo < 10)            app.activeDocument.save(File("~/Desktop/export/0"+ prefixo + "_0" + (numQuest) + ".indd"));        else            app.activeDocument.save(File("~/Desktop/export/"+ prefixo + "_0" + (numQuest) + ".indd"));    }    else    {        if(prefixo < 10)            app.activeDocument.save(File("~/Desktop/export/0"+ prefixo + "_" + (numQuest) + ".indd"));        else            app.activeDocument.save(File("~/Desktop/export/"+ prefixo + "_" + (numQuest) + ".indd"));    }    app.activeDocument.close();}var countQuest;app.selection[0].parentStory.texts[0].select();var allParag = app.selection[0].parent.paragraphs;$.writeln(allParag[0].contents);app.findChangeGrepOptions.includeFootnotes = true;app.findGrepPreferences = null;app.findGrepPreferences.findWhat = "^XX.\\t";var myFound = app.activeDocument.findGrep();$.writeln(countQuest = myFound.length);var numQuest = 0;for(var i =0; i < allParag.length; i++){    if(allParag[i].contents.substring(0,8) == "Capítulo")    {        copyQuestion(numQuest);        prefixo++; numQuest = 0;    }    else if(allParag[i].contents.substring(0,3) == "XX.")    {        if(numQuest > 0)            copyQuestion(numQuest);        $.writeln(allParag[i].contents.substring(0,3));        allParag[i].select();        numQuest++;    }    else    {        allParag[i].select(SelectionOptions.ADD_TO);    }}// Pra finalizarcopyQuestion(numQuest);if(numQuest != countQuest)    alert("ERRO 001");//~ for(var i = 0; i<count; i++)//~ {//~     app.copy();//~     app.documents.add().textFrames.add({geometricBounds : [12.7, 12.7, 271.6, 184.6]}); // Tem que ser em mm//~     app.activeDocument.allPageItems[0].parentStory.texts[0].select();//~     app.paste();//~     alladin = app.selection[0].paragraphs;//~    //~     app.activeDocument.save(File("~/Desktop/export/"+(i+1)+".indd"));//~     app.activeDocument.close();//~ }//~ $.writeln(simba[0].contents);//~ simba[0].contents = simba[2].contents ;//~ var frame = app.activeDocument.allPageItems;//~ frame.sort();//~ for(var i = 0; i < frame.length; i++)//~ {//~     if(frame[i].toString() == '[object TextFrame]')//~     {$.writeln (frame[i].contents); alert(frame[i].contents);}//~     //~ }//~ if (aFile != null)//~ {//~     aFile.open("r");//~     var count = 0;//~     while(!aFile.eof)//~     {//~         myList.push(aFile.readln());//~         count++;//~     }//~     $.writeln(myList);//~     $.writeln("TAMANHO: " + myList.length);//~ }//~ else//~     exit();//~ $.writeln(aFile.path);//~ for(var k = 0; k < myList.length; k++)  //~ {//~     //~     if(app.open(File("~/Desktop/import/" + myList[k])))//~     {//~         simba = app.activeDocument.allPageItems;//~         simba[0].parentStory.texts[0].select();//~         app.copy();//~         app.activeDocument.close();//~         app.paste();//~         app.selection[0].contents += '\r';//~     }//~     else//~     {//~         alert("Questão não está presente no banco de dados.");//~         exit();//~     }//~ }//~ var myList = File.selectDialog("Escolha a lista de arquivos *.txt");//~ if (myList != null)//~     var myIndsnFiles = myList.getFiles("*.indd");//~ else//~     exit();//~ $.writeln(myIndsnFiles);//~ for(var k = 0; k < myIndsnFiles.length; k++)  //~ {  //~     app.open(myIndsnFiles[k]);//~     simba = app.activeDocument.allPageItems;//~     simba[0].parentStory.texts[0].select();//~     app.copy();//~     app.activeDocument.close();//~     app.paste();//~     app.selection[0].contents += '\r';//~ }// app.selection[0] += fileWillBeInsert.contents;//$.writeln (app.selection[0].contents);// app.selection[0].autoTag();