// /*// 2015 Yuri Niitsuma <ignitzhjfk@gmail.com>// */// var aFolder = Folder.selectDialog("Escolha onde os indd se encontram!");// var arquivos = aFolder.getFiles("*.indd");function execute_VideoCode(){	var DocumentOpen = app.activeDocument;	var filePath = "~/Desktop/" + app.activeDocument.name + "_CodeExtract.txt";	var codeFile = new File(filePath);	//	codeFile.encoding = "ISO-8859";		codeFile.encoding = "UTF-8";	    codeFile.open("w");	var code = '\"ID\";\"Página\";\"Enunciado\"\n';	var temp,		questSize;	for (var i = 0; i < DocumentOpen.allPageItems.length; i++) {		if (DocumentOpen.allPageItems[i].toString() == '[object TextFrame]')		{			if (DocumentOpen.allPageItems[i].contents.length == 4)			{				questSize = 1; temp ='';				// DocumentOpen.allPageItems[i].parent.paragraphs[0].contents;				// while(isNaN(DocumentOpen.allPageItems[i].parent.paragraphs[questSize].contents.substring(0,2))				// 	&& DocumentOpen.allPageItems[i].parent.paragraphs[questSize].contents.substring(0,8).toUpperCase() != "GABARITO"				// 	&& DocumentOpen.allPageItems[i].parent.paragraphs[questSize].contents.substring(0,5).toUpperCase() != "SEÇÃO"				// 	&& DocumentOpen.allPageItems[i].parent.paragraphs[questSize].contents.substring(0,10).toUpperCase() != "EXERCÍCIOS")				// {				// 	temp += DocumentOpen.allPageItems[i].parent.paragraphs[questSize].contents;				// 	questSize++;				// }								temp = DocumentOpen.allPageItems[i].parent.paragraphs[0].contents;				temp = temp.replace(/\t/g, ' ');				temp = temp.replace(/\n/g, ' ');				// $.writeln(DocumentOpen.allPageItems[i].contents.substring(0,4));				code += DocumentOpen.allPageItems[i].contents + ';' + DocumentOpen.allPageItems[i].parentPage.name + ';\"' + temp.substring(0,temp.length-1) + '\"\n';				// $.writeln('-----------------------\n' + DocumentOpen.allPageItems[i].contents);				// $.writeln(DocumentOpen.allPageItems[i].parent.paragraphs[0].contents);			}		}	};	codeFile.write(code);	codeFile.close();}// var aFolder = Folder.selectDialog("Escolha onde os indd se encontram!");// var arquivos = aFolder.getFiles("*.indd");while(app.documents.length > 0){	execute_VideoCode();	app.activeDocument.close();}