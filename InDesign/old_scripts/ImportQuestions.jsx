/*2015 Yuri Niitsuma <ignitzhjfk@gmail.com>*/function doImport(){    var aFile = File.openDialog("Escolha a lista de arquivos *.txt");    var myList = new Array;    if (aFile != null)    {        aFile.open("r");        var count = 0;        while(!aFile.eof)        {            myList.push(aFile.readln());            count++;        }        $.writeln(myList);        $.writeln("TAMANHO: " + myList.length);    }    else        exit();    $.writeln(aFile.path);    for(var k = 0; k < myList.length; k++)      {        //~     app.selection[0].contents += (k+1).toString();        // if(app.open(File("~/Desktop/import/" + myList[k])))        if(app.open(File(aFile.path + '/' + myList[k] + '.indd')))        {            simba = app.activeDocument.allPageItems;            simba[0].parentStory.texts[0].select();            //~         insertBuffer = app.selection[0];            //~         alert(insertBuffer.parentStory.paragraphs.showText());            app.copy();            app.activeDocument.close();            app.paste();            app.selection[0].contents += '\r';        }        else        {            alert("Questão não está presente no banco de dados.");            exit();        }    }}function doQuestionNumber(){    app.findChangeGrepOptions.includeFootnotes = true;    app.findGrepPreferences = null;    app.findGrepPreferences.findWhat = "^XX.\t";    var myFound = app.activeDocument.findGrep();    for (var i = 0; i < myFound.length; i++)    {        $.writeln(myFound[i].contents);        if(i < 9)            myFound[i].contents = "0" + (i+1).toString() + ".\t";        else            myFound[i].contents = (i+1).toString() + ".\t";        // myFound[i].contents = myFound[i].contents.toLowerCase();        // myFound[i].capitalization = Capitalization.smallCaps;    }    $.writeln(myFound);}function doXX(){    app.findChangeGrepOptions.includeFootnotes = true;    app.findGrepPreferences = null;    app.findGrepPreferences.findWhat = "^\\d\\d.\\t";    var myFound = app.activeDocument.findGrep();    for (var i = 0; i < myFound.length; i++)    {        $.writeln(myFound[i].contents);        myFound[i].contents = "XX.\t";    }    $.writeln(myFound);}function myDisplayDialog(){    var myDialog, myTabButtons;    with(myDialog = app.dialogs.add({name:"Mano Menezes Questões v0.1 - Yuri Niitsuma <ignitzhjfk@gmail.com>"})){        with(dialogColumns.add()){            with(borderPanels.add()){                  staticTexts.add({staticLabel:"Escolha a opção:"});                with(myTabButtons = radiobuttonGroups.add()){                    radiobuttonControls.add({staticLabel:"Importar questões", checkedState:true});                    radiobuttonControls.add({staticLabel:"Re-enumerar \"^XX.\\t\""});                    radiobuttonControls.add({staticLabel:"Transformar para \"^XX.\\t\""});                }            }            // with(borderPanels.add()){            //    staticTexts.add({staticLabel:"Eu amos vocês"});            //}        }    }    var myResult = myDialog.show();    if(myResult == true){        // var myTabType = myTabButtons.selectedButton;        switch(myTabButtons.selectedButton)        {            case 0:                doImport();                break;            case 1:                doQuestionNumber();                break;            case 2:                doXX();                break;        }        myDialog.destroy();    }    else{        myDialog.destroy();    }}// var pass = prompt("Script para utilização no Núcleo de Matemática, versão de testes.","Insira sua senha aqui");// if (pass == "121213")    myDisplayDialog();// else    //alert("Senha errada.");