var myDoc = app.activeDocument; var myPrepend = prompt("Example: thebook_08765", "Job description", "Please enter job description"); if (!myPrepend) exit(); var response = confirm("Warning: You are about to rename all images linked to the foremost Indesign Document - proceed? Keep in mind - it is not reversible!", false, "Rename Links Script");var doc = app.activeDocument,      links = doc.allGraphics, count = 1, eqcount = 1, a = "0000";  for(var i=links.length-1;i>=0;i--)  {          if(links[i].itemLink.name.match(/^Icon.+/))          {              //do nothing            }          else          {                  var ext = links[i].itemLink.name.substr(links[i].itemLink.name.lastIndexOf(".")),                      old = File(links[i].itemLink.filePath),                      num = (count++).toString(),                      newname = myPrepend + a.substring(0, a.length - num.length) + num + ext                  old.rename(newname);                  links[i].itemLink.relink(File(old.toString().replace(links[i].itemLink.name,newname)));            }      }  